<!DOCTYPE html>
<html lang="pl">
<script src="/js/lunr.min.js"></script><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Przykłady refaktoryzacji na podstawie książki Martina Fowlera i Kenta Becka ‘Refactoring’ | Consdata - blog techniczny</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="Przykłady refaktoryzacji na podstawie książki Martina Fowlera i Kenta Becka ‘Refactoring’" />
<meta name="author" content="sucuncu" />
<meta property="og:locale" content="pl" />
<meta name="description" content="Książka ‘Refactoring’ Martina Fowlera i Kenta Becka została po raz pierwszy wydana w 1999 roku i często określana jest jako pozycja wybitna, ponadczasowa, jako must read każdego programisty. Dodatkowo w tym roku wyszła jej druga edycja. Po co?" />
<meta property="og:description" content="Książka ‘Refactoring’ Martina Fowlera i Kenta Becka została po raz pierwszy wydana w 1999 roku i często określana jest jako pozycja wybitna, ponadczasowa, jako must read każdego programisty. Dodatkowo w tym roku wyszła jej druga edycja. Po co?" />
<link rel="canonical" href="https://blog.consdata.tech/2019/05/06/refactoring.html" />
<meta property="og:url" content="https://blog.consdata.tech/2019/05/06/refactoring.html" />
<meta property="og:site_name" content="Consdata - blog techniczny" />
<meta property="og:image" content="https://blog.consdata.tech/assets/img/posts/2019-05-06-refactoring/refactoring.jpg" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2019-05-06T03:15:00-05:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="https://blog.consdata.tech/assets/img/posts/2019-05-06-refactoring/refactoring.jpg" />
<meta property="twitter:title" content="Przykłady refaktoryzacji na podstawie książki Martina Fowlera i Kenta Becka ‘Refactoring’" />
<script type="application/ld+json">
{"author":{"@type":"Person","name":"sucuncu"},"@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.consdata.tech/2019/05/06/refactoring.html"},"description":"Książka ‘Refactoring’ Martina Fowlera i Kenta Becka została po raz pierwszy wydana w 1999 roku i często określana jest jako pozycja wybitna, ponadczasowa, jako must read każdego programisty. Dodatkowo w tym roku wyszła jej druga edycja. Po co?","url":"https://blog.consdata.tech/2019/05/06/refactoring.html","image":"https://blog.consdata.tech/assets/img/posts/2019-05-06-refactoring/refactoring.jpg","headline":"Przykłady refaktoryzacji na podstawie książki Martina Fowlera i Kenta Becka ‘Refactoring’","dateModified":"2019-05-06T03:15:00-05:00","datePublished":"2019-05-06T03:15:00-05:00","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css?family=Raleway:400,700,600,500,300,200,100,800,900" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com/css?family=Ubuntu+Mono:400,700,600,500,300,200,100,800,900" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@100;400;500;700&display=swap" rel="stylesheet">
  <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" crossorigin="anonymous">
  <link rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://blog.consdata.tech/feed.xml" title="Consdata - blog techniczny" /><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-NFV6DPR');</script>


  <link rel="icon" type="image/x-icon" href="/favicon.ico">
</head>
<body>---
---
<nav class="site-header">
    <div class="container">
        <div class="header navbar-default" role="navigation">
            <div class="header-brand">
                <div class="nav navbar-nav">
                    <div class="nav-link"><a href="/">BLOG.CONSDATA.TECH</a></div>
                </div>

                <div class="mobile-search">
                    
<form action="/search.html" method="get">

    <div class="search-input-container">
        <input type="text" placeholder="Szukaj..." id="search-box-mobile" name="query" class="search-input" autocomplete="off">
        <i class="fa fa-search search-icon" onclick="expandInputMobile()"></i>
    </div>
</form>

<script>
    const inputMobile = document.getElementById("search-box-mobile");
    const logo = document.getElementById("header-logo");
    const expandInputMobile = () => {
        inputMobile.classList.toggle("expanded");
        logo.classList.toggle("header-logo");
        logo.classList.toggle("logo-invisible");
    };
</script>

                </div>
            </div>
            <div id="header-links" class="mobile-nav">
                <a class="header-logo" href="https://consdata.com/pl">
                    <img src="/assets/img/logo-nowe.png" alt="consdata.com">
                </a>
                <div class="feed-subscribe">
                    <a href="/feed.xml">
                    <svg class="svg-icon">
                        <use xlink:href="/assets/minima-social-icons.svg#rss"></use>
                    </svg>
                    </a>
                </div>
                
            </div>

        </div>
    </div>
</nav>
<script>
    function navigate(baseUrl) {
        const queryParams = window.location.search;
        window.location.href = baseUrl + queryParams;
    }
</script>





<div class="navigation-bar">
    <div class="row">
        <div class="col-15 desktop-navbar">
            <div class="col-2-3 navbar-links">
                <div class="navigation-tags">
                    
                        
                        <a href="/search.html?query=programming">
                        
                        PROGRAMMING
                        </a>
                    
                        
                        <a href="/search.html?query=serverless">
                        
                        SERVERLESS
                        </a>
                    
                        
                        <a href="/search.html?query=mongodb">
                        
                        MONGODB
                        </a>
                    
                        
                        <a href="/search.html?query=gcp">
                        
                        GCP
                        </a>
                    
                        
                        <a href="/search.html?query=frontend">
                        
                        FRONTEND
                        </a>
                    
                </div>
                
<form action="/search.html" method="get">

    <div class="search-input-container">
        <input type="text" placeholder="Szukaj..." id="search-box" name="query" class="search-input" autocomplete="off">
        <i class="fa fa-search search-icon" onclick="expandInputDesktop()"></i>
    </div>
</form>

<script>
    const inputDesktop = document.getElementById("search-box");
    const expandInputDesktop = () => {
        inputDesktop.classList.toggle("expanded");
    };
</script>

            </div>
            <div class="col-1-3">
                <a href="https://app2.salesmanago.pl/mscf/e7yrrpjmxbm7bahc/default/Landing_page_newsletter_techniczny.htm"
                   class="newsletter-link">
                    <div class="newsletter-button">
                        Zapisz się na newsletter techniczny
                    </div>
                </a>
            </div>
        </div>
        <div class="col-15 mobile-navbar">
            <div class="navigation-tags">
                
                
                    <a href="/search.html?query=programming">
                        
                        PROGRAMMING
                    </a>
                    
                
                    <a href="/search.html?query=serverless">
                        
                        SERVERLESS
                    </a>
                    
                
                    <a href="/search.html?query=mongodb">
                        
                        MONGODB
                    </a>
                    
                
                    <a href="/search.html?query=gcp">
                        
                        GCP
                    </a>
                    
                
                    <a href="/search.html?query=frontend">
                        
                        FRONTEND
                    </a>
                    
            </div>
            <a href="https://app2.salesmanago.pl/mscf/e7yrrpjmxbm7bahc/default/Landing_page_newsletter_techniczny.htm"
               class="newsletter-link">
                <div class="newsletter-button">Zapisz się na newsletter techniczny</div>
            </a>
        </div>
    </div>
</div>
<main class="page-content" aria-label="Content">
    


<div class="blog">
    <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
        <header>
            <div class="row back-link-row">
    <div class="col-15">
        <a href="/" class="main-page-link-container">
            <i class="fa fa-arrow-left"></i>
                Wszystkie wpisy
        </a>
    </div>
</div>

            <div class="row">
                <div class="col-15">
                    <h1 class="post-big-title p-name" itemprop="name headline">Przykłady refaktoryzacji na podstawie książki Martina Fowlera i Kenta Becka &#39;Refactoring&#39;</h1>
                </div>
            </div>
            <div class="row">
                <div class="col-15">
                    <div class="post-metadata">

    <a href="/authors/sucuncu.html" class="author-name">
        <img class="big-author-image" src="/assets/img/authors/sucuncu.jpg" alt="author"></a>
    <div class="post-info"><a href="/authors/sucuncu.html" class="author-name-metadata">Sylwia Üçüncü</a>
        <span>
6

maja



2019
</span>
    </div>


</div>

                </div>
                <div class="col-5">
                    

                </div>
            </div>
        </header>
        <div itemprop="articleBody" class="post-content-container">
            <div class="post-content-left-pane">
                <div class="post-content">
                    <div class=" post-highlight-image">
                        <img src="/assets/img/posts/2019-05-06-refactoring/refactoring.jpg" alt="postimage"/>
                    </div>
                    <div class="social-media-sharing">
                        <div id="share-bar">
    <div class="share-buttons">
        <a href="https://www.facebook.com/sharer/sharer.php?u=https://blog.consdata.tech/2019/05/06/refactoring.html"
           onclick="window.open(this.href, 'pop-up', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;"
           title="Podziel się na Facebooku">
            <i class="fa fa-facebook-official share-button"></i>
        </a>

        <a href="https://twitter.com/intent/tweet?text=Przykłady refaktoryzacji na podstawie książki Martina Fowlera i Kenta Becka 'Refactoring'&url=https://blog.consdata.tech/2019/05/06/refactoring.html"
           onclick="window.open(this.href, 'pop-up', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;"
           title="Podziel się na Twitterze">
            <i class="fa fa-twitter share-button"> </i>
        </a>

        <a href="https://www.linkedin.com/shareArticle?mini=true&url=https://blog.consdata.tech/2019/05/06/refactoring.html&title=Przykłady refaktoryzacji na podstawie książki Martina Fowlera i Kenta Becka 'Refactoring'&source=Consdata - blog techniczny"
           onclick="window.open(this.href, 'pop-up', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;"
           title="Podziel się na LinkedIn">
            <i class="fa fa-linkedin share-button"></i>
        </a>

    </div>

</div>

                    </div>
                    <div id="myModal" class="modal">
                        <i id="modal-close" class="fa fa-times close" aria-hidden="true"
                           onclick="closeModal()"></i>
                        <img class="modal-content">
                    </div>
                    <p>Książka “Refactoring” Martina Fowlera i Kenta Becka została po raz pierwszy wydana w 1999 roku i często określana jest jako pozycja wybitna, ponadczasowa, jako must read każdego programisty. 
Dodatkowo w tym roku wyszła jej druga edycja. Po co?</p>

<p>Martin podkreśla przecież, że notatki z lat dziewięćdziesiątych, które tworzył i ogólnie zasady refaktoryzacji wciąż są aktualne i wciąż sam ich używa. Mimo to wszystkie jej rozdziały zostały przepisane, a przede wszystkim zmienił się język wykorzystany w przykładach - wtedy wybrali Javę, tym razem postawili na JavaScript.</p>

<p>Dominująca część tej pozycji to katalog reguł refaktoryzacji wraz z motywacją, sposobem jej wykonania i oczywiście kodem. 
Zanim jednak tam dotrzemy, Fowler próbuje wytłumaczyć, po co w ogóle refaktoryzować i kiedy to robić.
I to, co najbardziej wyniosłam z tej lektury to podejście, które przewija się w niej bardzo często: mianowicie, że refaktoryzacja powinna być “częścią naturalnego flow programisty”.</p>

<p>Gdy podchodzimy do zadania, chcemy dodać nową funkcjonalność, powinniśmy móc ją wprowadzić w zastany kod w sposób łatwy i ładny. Jeśli jednak jego stan nam na to nie pozwala, może powinniśmy pokusić się o jego reorganizację, tak żebyśmy mogli później szybko i bez wyrzutów sumienia wprowadzać zmiany. Bardzo trafnie opisuje to cytat:</p>

<blockquote>"It's like I want to go 100 miles east but instead of just traipsing through the woods, I'm going to drive 20 miles north to the highway and then I'm going to go 100 miles east at three times the speed I could have if I just went straight there. When people are pushing you to just go straight there, sometimes you need to say 'Wait, I need to check the map and find the quickest route'."</blockquote>
<p>Zanim przejdziemy do przykładów, jeszcze jedna motywacja, czyli to, jak określa sam siebie Kent Beck:</p>

<blockquote>"I'm not a great programmer. I'm just a good programmer with great habits."</blockquote>

<h2 id="przykład-pierwszy">Przykład pierwszy</h2>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">solveIdealRocketEquation</span><span class="p">(</span><span class="nx">specificImpulse</span><span class="p">,</span> <span class="nx">initialMass</span><span class="p">,</span> <span class="nx">finalMass</span><span class="p">)</span> <span class="p">{</span>
	<span class="kd">const</span> <span class="nx">exhaustVelocity</span> <span class="o">=</span> <span class="nx">specificImpulse</span> <span class="o">*</span> <span class="mf">9.81</span><span class="p">;</span>
	<span class="kd">const</span> <span class="nx">massFraction</span> <span class="o">=</span> <span class="nx">initialMass</span><span class="o">/</span><span class="nx">finalMass</span><span class="p">;</span>
	<span class="k">return</span> <span class="nx">exhaustVelocity</span> <span class="o">*</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">massFraction</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div></div>
<p>Refaktor powyższego przykładu rozpoczniemy od zastosowania wyodrębnienia metod (Extract Function).</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">solveIdealRocketEquation</span><span class="p">(</span><span class="nx">specificImpulse</span><span class="p">,</span> <span class="nx">initialMass</span><span class="p">,</span> <span class="nx">finalMass</span><span class="p">)</span> <span class="p">{</span>
	<span class="kd">const</span> <span class="nx">exhaustVelocity</span> <span class="o">=</span> <span class="nx">specificImpulse</span> <span class="o">*</span> <span class="mf">9.81</span><span class="p">;</span>
	<span class="kd">const</span> <span class="nx">massFraction</span> <span class="o">=</span> <span class="nx">initialMass</span><span class="o">/</span><span class="nx">finalMass</span><span class="p">;</span>
	<span class="k">return</span> <span class="nx">calculateVelocity</span><span class="p">(</span><span class="nx">exhaustVelocity</span><span class="p">,</span> <span class="nx">massFraction</span><span class="p">)</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">calculateVelocity</span><span class="p">(</span><span class="nx">exhaustVelocity</span><span class="p">,</span> <span class="nx">massFraction</span><span class="p">){</span>
	<span class="k">return</span> <span class="nx">exhaustVelocity</span> <span class="o">*</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">massFraction</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Następnie wprowadzimy strukturę służącą do komunikacji (Introduce Parameter Object).</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">solveIdealRocketEquation</span><span class="p">(</span><span class="nx">specificImpulse</span><span class="p">,</span> <span class="nx">initialMass</span><span class="p">,</span> <span class="nx">finalMass</span><span class="p">)</span> <span class="p">{</span>
	<span class="kd">const</span> <span class="nx">exhaustVelocity</span> <span class="o">=</span> <span class="nx">specificImpulse</span> <span class="o">*</span> <span class="mf">9.81</span><span class="p">;</span>
	<span class="kd">const</span> <span class="nx">massFraction</span> <span class="o">=</span> <span class="nx">initialMass</span><span class="o">/</span><span class="nx">finalMass</span><span class="p">;</span>
	<span class="kd">const</span> <span class="nx">velocityData</span> <span class="o">=</span> <span class="p">{</span><span class="na">exhaustVelocity</span><span class="p">:</span> <span class="nx">exhaustVelocity</span><span class="p">,</span> <span class="na">massFraction</span><span class="p">:</span> <span class="nx">massFraction</span><span class="p">}</span>
	<span class="k">return</span> <span class="nx">calculateVelocity</span><span class="p">(</span><span class="nx">velocityData</span><span class="p">)</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">calculateVelocity</span><span class="p">(</span><span class="nx">velocityData</span><span class="p">){</span>
	<span class="k">return</span> <span class="nx">velocityData</span><span class="p">.</span><span class="nx">exhaustVelocity</span> <span class="o">*</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">velocityData</span><span class="p">.</span><span class="nx">massFraction</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div></div>

<p>I z tak posprzątanymi parametrami, możemy wydzielić dwie, niezależne fazy naszych obliczeń (Split Phase).</p>
<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">solveIdealRocketEquation</span><span class="p">(</span><span class="nx">specificImpulse</span><span class="p">,</span> <span class="nx">initialMass</span><span class="p">,</span> <span class="nx">finalMass</span><span class="p">)</span> <span class="p">{</span>
	<span class="kd">const</span> <span class="nx">velocityData</span> <span class="o">=</span> <span class="nx">calculateVelocityData</span><span class="p">(</span><span class="nx">specificImpulse</span><span class="p">,</span> <span class="nx">initialMass</span><span class="p">,</span> <span class="nx">finalMass</span><span class="p">)</span>
	<span class="k">return</span> <span class="nx">calculateVelocity</span><span class="p">(</span><span class="nx">velocityData</span><span class="p">)</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">calculateVelocity</span><span class="p">(</span><span class="nx">velocityData</span><span class="p">){</span>
	<span class="k">return</span> <span class="nx">velocityData</span><span class="p">.</span><span class="nx">exhaustVelocity</span> <span class="o">*</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">velocityData</span><span class="p">.</span><span class="nx">massFraction</span><span class="p">)</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">calculateVelocityData</span><span class="p">(</span><span class="nx">specificImpulse</span><span class="p">,</span> <span class="nx">initialMass</span><span class="p">,</span> <span class="nx">finalMass</span><span class="p">){</span>
	<span class="kd">const</span> <span class="nx">exhaustVelocity</span> <span class="o">=</span> <span class="nx">specificImpulse</span> <span class="o">*</span> <span class="mf">9.81</span><span class="p">;</span>
	<span class="kd">const</span> <span class="nx">massFraction</span> <span class="o">=</span> <span class="nx">initialMass</span><span class="o">/</span><span class="nx">finalMass</span><span class="p">;</span>
	<span class="k">return</span> <span class="p">{</span><span class="na">exhaustVelocity</span><span class="p">:</span> <span class="nx">exhaustVelocity</span><span class="p">,</span> <span class="na">massFraction</span><span class="p">:</span> <span class="nx">massFraction</span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="przykład-drugi">Przykład drugi</h2>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">aggregateStarsData</span><span class="p">(</span><span class="nx">stars</span><span class="p">){</span>
    <span class="kd">let</span> <span class="nx">highestTemperature</span> <span class="o">=</span> <span class="nx">stars</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">?</span> <span class="nx">stars</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">temperature</span> <span class="p">:</span> <span class="mi">0</span><span class="p">;</span>
    <span class="kd">let</span> <span class="nx">totalMass</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">const</span> <span class="nx">s</span> <span class="k">of</span> <span class="nx">stars</span><span class="p">)</span> <span class="p">{</span>
	    <span class="k">if</span> <span class="p">(</span><span class="nx">s</span><span class="p">.</span><span class="nx">temperature</span> <span class="o">&gt;</span> <span class="nx">highestTemperature</span><span class="p">)</span> <span class="p">{</span>
		<span class="nx">highestTemperature</span> <span class="o">=</span> <span class="nx">s</span><span class="p">.</span><span class="nx">temperature</span>
	    <span class="p">}</span>
	<span class="nx">totalMass</span> <span class="o">+=</span> <span class="nx">s</span><span class="p">.</span><span class="nx">mass</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="p">{</span><span class="na">highestTemperature</span><span class="p">:</span> <span class="nx">highestTemperature</span><span class="p">,</span> <span class="na">totalMass</span><span class="p">:</span> <span class="nx">totalMass</span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>
<p>W powyższym przykładzie obliczamy łączną masę gwiazd oraz znajdujemy gwiazdę, której temperatura jest najwyższa. Wyliczenia te przetwarzane są w tej samej pętli, chociaż są od siebie niezależne. Minusem tego podejścia jest to, że za każdym razem, gdy będziemy chcieli taką pętlę zmodyfikować, będziemy musieli zrozumieć obie te rzeczy. Podzielmy ją więc na dwie, tak abyśmy mogli próbować zrozumieć tylko tę część, którą musimy zmodyfikować (Split Loop).</p>
<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">aggregateStarsData</span><span class="p">(</span><span class="nx">stars</span><span class="p">){</span>
    <span class="kd">let</span> <span class="nx">highestTemperature</span> <span class="o">=</span> <span class="nx">stars</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">?</span> <span class="nx">stars</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">temperature</span> <span class="p">:</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">const</span> <span class="nx">s</span> <span class="k">of</span> <span class="nx">stars</span><span class="p">)</span> <span class="p">{</span>
	    <span class="k">if</span> <span class="p">(</span><span class="nx">s</span><span class="p">.</span><span class="nx">temperature</span> <span class="o">&gt;</span> <span class="nx">highestTemperature</span><span class="p">)</span> <span class="p">{</span>
		    <span class="nx">highestTemperature</span> <span class="o">=</span> <span class="nx">s</span><span class="p">.</span><span class="nx">temperature</span>
	    <span class="p">}</span>
    <span class="p">}</span>
    <span class="kd">let</span> <span class="nx">totalMass</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="kd">const</span> <span class="nx">s</span> <span class="k">of</span> <span class="nx">stars</span><span class="p">)</span> <span class="p">{</span>
	        <span class="nx">totalMass</span> <span class="o">+=</span> <span class="nx">s</span><span class="p">.</span><span class="nx">mass</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="p">{</span><span class="na">highestTemperature</span><span class="p">:</span> <span class="nx">highestTemperature</span><span class="p">,</span> <span class="na">totalMass</span><span class="p">:</span> <span class="nx">totalMass</span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Następnie powydzielajmy metody (Extract Function).</p>
<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">aggregateStarsData</span><span class="p">(</span><span class="nx">stars</span><span class="p">){</span>
	<span class="k">return</span> <span class="p">{</span><span class="na">highestTemperature</span><span class="p">:</span> <span class="nx">highestTemperature</span><span class="p">(</span><span class="nx">stars</span><span class="p">),</span> <span class="na">totalMass</span><span class="p">:</span> <span class="nx">totalMass</span><span class="p">(</span><span class="nx">stars</span><span class="p">)}</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">highestTemperature</span><span class="p">(</span><span class="nx">stars</span><span class="p">){</span>
	<span class="kd">let</span> <span class="nx">highestTemperature</span> <span class="o">=</span> <span class="nx">stars</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">?</span> <span class="nx">stars</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">temperature</span> <span class="p">:</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">for</span> <span class="p">(</span><span class="kd">const</span> <span class="nx">s</span> <span class="k">of</span> <span class="nx">stars</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="nx">s</span><span class="p">.</span><span class="nx">temperature</span> <span class="o">&gt;</span> <span class="nx">highestTemperature</span><span class="p">)</span> <span class="p">{</span>
			<span class="nx">highestTemperature</span> <span class="o">=</span> <span class="nx">s</span><span class="p">.</span><span class="nx">temperature</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="nx">highestTemperature</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">totalMass</span><span class="p">(</span><span class="nx">stars</span><span class="p">){</span>
	<span class="kd">let</span> <span class="nx">totalMass</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">for</span> <span class="p">(</span><span class="kd">const</span> <span class="nx">s</span> <span class="k">of</span> <span class="nx">stars</span><span class="p">)</span> <span class="p">{</span>
		<span class="nx">totalMass</span> <span class="o">+=</span> <span class="nx">s</span><span class="p">.</span><span class="nx">mass</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="nx">totalMass</span><span class="p">;</span>
<span class="p">}</span>

</code></pre></div></div>
<p>I użyjmy jeszcze dwóch metod refaktoryzacji: Replace Loop with Pipeline oraz Subsitute Algorithm.</p>
<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">aggregateStarsData</span><span class="p">(</span><span class="nx">stars</span><span class="p">){</span>
	<span class="k">return</span> <span class="p">{</span><span class="na">highestTemperature</span><span class="p">:</span> <span class="nx">highestTemperature</span><span class="p">(</span><span class="nx">stars</span><span class="p">),</span> <span class="na">totalMass</span><span class="p">:</span> <span class="nx">totalMass</span><span class="p">(</span><span class="nx">stars</span><span class="p">)}</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">highestTemperature</span><span class="p">(</span><span class="nx">stars</span><span class="p">){</span>
    <span class="k">return</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(...</span><span class="nx">stars</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">s</span><span class="o">=&gt;</span> <span class="nx">s</span><span class="p">.</span><span class="nx">temperature</span><span class="p">))</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">totalMass</span><span class="p">(</span><span class="nx">stars</span><span class="p">){</span>
    <span class="k">return</span> <span class="nx">stars</span><span class="p">.</span><span class="nx">reduce</span><span class="p">((</span><span class="nx">totalMass</span><span class="p">,</span> <span class="nx">s</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">totalMass</span> <span class="o">+=</span> <span class="nx">s</span><span class="p">.</span><span class="nx">mass</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="podsumowanie">Podsumowanie</h2>

<p>“Refactoring” Fowlera i Becka to książka, którą na pewno docenią osoby, które pracują przy dużych i długofalowych projektach. Wtedy bowiem potrzeba refaktorowania jest bezdyskusyjna, jednak jest on czasochłonny i ryzykowny. Łatwo wpaść w pułapkę, w której zmiany, które dodajemy, wprowadzają bałagan do kodu i tłumaczone są pośpiechem. Jednak czas, który zaoszczędzimy przy jej dodawaniu, zostanie zjedzony w całości, a pewnie i przekroczony, gdy kolejna osoba będzie musiała wejść w nasze klasy i zrozumieć, jak to właściwie działa.</p>

<p>Podejdźmy więc do problemu zdrowo i po prostu - zawsze zostawiajmy kod choć odrobinę lepszym, niż ten który zastaliśmy;)</p>

                    
                    
                    
                </div>
            </div>
            <div class="sidebar">
                
<div class="sidebar-container">
    <div class="sidebar-title">
        Najnowsze wpisy
    </div>
    <div class="sidebar-latest-posts-container">
        <ul class="sidebar-posts"><li class="sidebar-post no-breaking-word">
                <a href="/2024/02/23/czy-wiesz-czym-jest-i-jak-dziala-webworker.html" lang="pl">Czy wiesz, czym jest i jak działa WebWorker?</a>
            </li><li class="sidebar-post no-breaking-word">
                <a href="/2024/01/26/czy-wiesz-jak-bezprzerwowo-zmienic-schemat-w-mongodb.html" lang="pl">Czy wiesz, jak bezprzerwowo zmienić schemat w MongoDB?</a>
            </li><li class="sidebar-post no-breaking-word">
                <a href="/2024/01/26/czy-wiesz-czym-jest-attribute-pattern-w-mongodb.html" lang="pl">Czy wiesz czym jest Attribute Pattern w MongoDB?</a>
            </li></ul>
    </div>
</div>

                <div class="sidebar-container" id="recommended-posts-sidebar">
    <div class="sidebar-title">
        Podobne wpisy
    </div>
    <div class="sidebar-latest-posts-container">
        <ul class="sidebar-posts" id="recommended-posts-desktop">

        </ul>
    </div>
</div>

                <div class="sidebar-container" id="recommended-posts-sidebar">
    <div class="sidebar-title">
        Dołącz do nas
    </div>
    <div class="sidebar-last-posts-container">
        <ul class="sidebar-posts">
            <li class="sidebar-post no-breaking-word">
                <a href="https://consdata.com/pl/kariera/trwajace-rekrutacje/poznan/senior-fullstack-developer-java-angular"
                   lang="pl">
                    <div class="job-offer">
                        <span class="job-title">SENIOR FULLSTACK DEVELOPER (JAVA + ANGULAR)</span>
                        <span class="job-description">Poznań (hybrydowo) lub zdalnie</span>
                        <span class="job-salary">
                            UoP 14 900 - 20 590 PLN brutto <br/>
                            B2B 19 680 - 27 220 PLN netto
                        </span>
                    </div>
                </a>
            </li>
            <li class="sidebar-post no-breaking-word">
                <a href="https://consdata.com/pl/kariera/trwajace-rekrutacje/poznan/regular-fullstack-developer-java-angular"
                   lang="pl">
                    <div class="job-offer">
                        <span class="job-title">REGULAR FULLSTACK DEVELOPER (JAVA + ANGULAR)</span>
                        <span class="job-description">Poznań (hybrydowo) lub zdalnie</span>
                        <span class="job-salary">
                            UoP 11 300 - 15 900 PLN brutto <br/>
                            B2B 14 950 - 21 000 PLN netto
                        </span>
                    </div>
                </a>
            </li>
            <li class="sidebar-post no-breaking-word">
                <a class="clickable-offer" href="https://www.consdata.com/pl/kariera/trwajace-rekrutacje#tag-developer">
                    <div class="other-job-offers">
                        <span class="job-title">ZOBACZ WSZYSTKIE OGŁOSZENIA</span>
                    </div>
                </a>
            </li>
        </ul>
    </div>
</div>

            </div>
        </div>
        <div class="post-post-section-mobile">
            
<div class="sidebar-container">
    <div class="sidebar-title">
        Najnowsze wpisy
    </div>
    <div class="sidebar-latest-posts-container">
        <ul class="sidebar-posts"><li class="sidebar-post no-breaking-word">
                <a href="/2024/02/23/czy-wiesz-czym-jest-i-jak-dziala-webworker.html" lang="pl">Czy wiesz, czym jest i jak działa WebWorker?</a>
            </li><li class="sidebar-post no-breaking-word">
                <a href="/2024/01/26/czy-wiesz-jak-bezprzerwowo-zmienic-schemat-w-mongodb.html" lang="pl">Czy wiesz, jak bezprzerwowo zmienić schemat w MongoDB?</a>
            </li><li class="sidebar-post no-breaking-word">
                <a href="/2024/01/26/czy-wiesz-czym-jest-attribute-pattern-w-mongodb.html" lang="pl">Czy wiesz czym jest Attribute Pattern w MongoDB?</a>
            </li></ul>
    </div>
</div>

        </div>
        <div class="post-post-section-mobile">
            <div class="sidebar-container" id="recommended-posts-bottombar">
    <div class="sidebar-title">
        Podobne wpisy
    </div>
    <div class="sidebar-latest-posts-container">
        <ul class="sidebar-posts" id="recommended-posts-mobile">

        </ul>
    </div>
</div>

        </div>
        <div class="post-post-section-mobile">
            <div class="sidebar-container" id="recommended-posts-sidebar">
    <div class="sidebar-title">
        Dołącz do nas
    </div>
    <div class="sidebar-last-posts-container">
        <ul class="sidebar-posts">
            <li class="sidebar-post no-breaking-word">
                <a href="https://consdata.com/pl/kariera/trwajace-rekrutacje/poznan/senior-fullstack-developer-java-angular"
                   lang="pl">
                    <div class="job-offer">
                        <span class="job-title">SENIOR FULLSTACK DEVELOPER (JAVA + ANGULAR)</span>
                        <span class="job-description">Poznań (hybrydowo) lub zdalnie</span>
                        <span class="job-salary">
                            UoP 14 900 - 20 590 PLN brutto <br/>
                            B2B 19 680 - 27 220 PLN netto
                        </span>
                    </div>
                </a>
            </li>
            <li class="sidebar-post no-breaking-word">
                <a href="https://consdata.com/pl/kariera/trwajace-rekrutacje/poznan/regular-fullstack-developer-java-angular"
                   lang="pl">
                    <div class="job-offer">
                        <span class="job-title">REGULAR FULLSTACK DEVELOPER (JAVA + ANGULAR)</span>
                        <span class="job-description">Poznań (hybrydowo) lub zdalnie</span>
                        <span class="job-salary">
                            UoP 11 300 - 15 900 PLN brutto <br/>
                            B2B 14 950 - 21 000 PLN netto
                        </span>
                    </div>
                </a>
            </li>
            <li class="sidebar-post no-breaking-word">
                <a class="clickable-offer" href="https://www.consdata.com/pl/kariera/trwajace-rekrutacje#tag-developer">
                    <div class="other-job-offers">
                        <span class="job-title">ZOBACZ WSZYSTKIE OGŁOSZENIA</span>
                    </div>
                </a>
            </li>
        </ul>
    </div>
</div>

        </div>
        <div class="author-bio">
    
    <div class="author-image">
        <a href="/authors/sucuncu.html" class="author-name">
            <img src="/assets/img/authors/sucuncu.jpg" alt="author" width="120" height="120">
        </a>
    </div>
    
    <div class="card">
        <div class="header">
            
            <a href="/authors/sucuncu.html" class="author-name">
                Sylwia Üçüncü
            </a>
            
            <div class="social-buttons">
                
                <div class="author-github">
                    <a href="https://github.com/sszadi"
                       title="sszadi">
                        <svg class="svg-icon grey">
                            <use xlink:href="/assets/minima-social-icons.svg#github"></use>
                        </svg>
                        sszadi</a>
                </div>
                
            </div>
        </div>
        <div class="content">
            
                
                    <div class="bio">Java Developer w Consdacie i weekendowo studentka Informatyki na Politechnice Poznańskiej. Chętnie zgłębia kolejne technologie i poszerza swoją wiedzę zarówno z backendu, jak i frontendu. W wolnym czasie ćwiczy, biega i czyta o Kosmosie.</div>
                
            
        </div>
    </div>
</div>
<div class="author-bio-mobile">
    <div class="header">
        
        <div class="author-image">
            <img src="/assets/img/authors/sucuncu.jpg">
        </div>
        
        <div class="name-wrapper">
            
            <div class="author-name">Sylwia Üçüncü</div>
            
            <div class="social-buttons">
                
                <div class="author-github">
                    <a href="https://github.com/sszadi"
                       title="sszadi">
                        <svg class="svg-icon grey">
                            <use xlink:href="/assets/minima-social-icons.svg#github"></use>
                        </svg>
                        sszadi</a>
                </div>
                
            </div>
        </div>
    </div>
    <div class="content">
        
            
            
                <div class="bio">Java Developer w Consdacie i weekendowo studentka Informatyki na Politechnice Poznańskiej. Chętnie zgłębia kolejne technologie i poszerza swoją wiedzę zarówno z backendu, jak i frontendu. W wolnym czasie ćwiczy, biega i czyta o Kosmosie.</div>
            
        
    </div>
</div>
<div id="disqus_thread"></div>
<script>
    function readCookie(name) {
        const nameEQ = name + "=";
        const ca = document.cookie.split(';');
        for (let i = 0; i < ca.length; i++) {
            let c = ca[i];
            while (c.charAt(0) === ' ') c = c.substring(1, c.length);
            if (c.indexOf(nameEQ) === 0) return c.substring(nameEQ.length, c.length);
        }
        return null;
    }

    if (readCookie('cookie-notice-dismissed') === 'true') {
        var disqus_config = function () {
            this.page.url = 'https://blog.consdata.tech/2019/05/06/refactoring.html';
            this.page.identifier = 'https://blog.consdata.tech/2019/05/06/refactoring.html';
        };

        (function () {
            var d = document, s = d.createElement('script');

            s.src = 'https://consdata-tech.disqus.com/embed.js';

            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
        })();
    }
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments
    powered by Disqus.</a></noscript></article>
</div>
<script>
    const language = 'pl';
    const jsonPath = language === 'en' ? '/en/json/posts.json' : '/json/posts.json';
    fetch(jsonPath)
        .then(response => response.json())
        .then(store => {
            function displayResults(results) {
                if (results.length > 0) {
                    const container = document.getElementById("recommended-posts-desktop");
                    const containerMobile = document.getElementById("recommended-posts-mobile");
                    results
                        .forEach(result => {
                            const item = store[result.ref];
                            if (item.lang === language) {
                                const listElement = document.createElement('li');
                                const anchor = document.createElement('a');
                                const postTitle = document.createTextNode(item.title);
                                listElement.classList.add('sidebar-post');
                                listElement.classList.add('no-breaking-word');
                                anchor.setAttribute('href', item.url);
                                anchor.setAttribute('lang', 'pl');
                                anchor.appendChild(postTitle);
                                listElement.appendChild(anchor);
                                container.appendChild(listElement);
                                containerMobile.appendChild(listElement.cloneNode(true));
                            }
                        });
                    if (container.children.length < 1) {
                        hideRecommendedPosts();
                    }
                } else {
                    hideRecommendedPosts();
                }

            }

            const tags = "refaktoryzacja javascript";
            const idx = lunr(function () {
                this.field('tags');

                for (let key in store) {
                    this.add({
                        'id': key,
                        'title': store[key].title,
                        'tags': store[key].tags,
                    });
                }
            });
            const results = idx.search(tags).slice(1, 4);
            displayResults(results);
        })

    function zoomImage($event) {
        const modal = document.getElementById('myModal');
        modal.getElementsByTagName('img')[0].src = $event.target.src;
        modal.style.display = 'flex';
    }

    function closeModal() {
        document.getElementById('myModal').style.display = 'none';
    }

    function hideRecommendedPosts() {
        document.getElementById("recommended-posts-sidebar").style.display = 'none';
        document.getElementById("recommended-posts-bottombar").style.display = 'none';
    }

    const postImages = document.querySelectorAll('.post-content img');
    postImages.forEach(x => x.addEventListener('click', zoomImage));
</script>

</main><footer>
    <div class="container">
        <div class="footer-item company">
            <div class="label">
                <img src="/assets/img/logo.png"/>
            </div>
            <div class="item-content">
                <p>
                    K9OFFICE, UL. KRYSIEWICZA 9/17<br/>
                    61-825 POZNAŃ<br/>
                    POLSKA
                </p>
                <p>
                    TEL.:+48 61 41 51 000
                </p>
                <p>
                    NIP: 1822261960<br/>
                    REGON: 634422180
                </p>
            </div>
        </div>
        <div class="footer-item legals">
            <div class="label">
                INFORMACJE
            </div>
            <div class="item-content">
                <p>
                    <a href="https://consdata.com/pl/polityka-prywatnosci" target="_blank">POLITYKA PRYWATNOŚCI </a>
                </p>
            </div>
        </div>
        <div class="footer-item social-buttons">
            <div class="label">
                POZOSTAŃ W KONTAKCIE
            </div>
            <div class="item-content">
                <div class="social-buttons-container">
                    <div class="social-button-wrapper">
                        <a class="social-btn" target="_blank" href="https://www.facebook.com/consdatacom"
                           title="Facebook">
                            <i class="fa fa-facebook"></i>
                        </a>
                    </div>
                    <div class="social-button-wrapper">
                        <a class="social-btn" target="_blank"
                           href="https://www.youtube.com/channel/UCv4d_uCiLdDkOFk8NtDsU_w" title="Youtube">
                            <i class="fa fa-youtube"></i>
                        </a>
                    </div>
                    <div class="social-button-wrapper">
                        <a class="social-btn" target="_blank" href="https://www.linkedin.com/company/1456906"
                           title="Linkedin">
                            <i class="fa fa-linkedin"></i>
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="copyright">
        Copyrights © 2024 CONSDATA
    </div>
</footer>
<div class="cookie-notice" id="cookie-notice">
    <span>
        
        Chcemy używać plików cookie oraz skryptów podmiotów trzecich do polepszania funkcjonowania tej strony
    </span>
    <a id="cookie-notice-accept" class="consent-button">Zgadzam się</a>
    <i onclick="hideConsent()" class="close-consent fa fa-times close"></i>
    <noscript><img height="1" width="1" style="display:none"
                   src="https://www.facebook.com/tr?id=300808861525851&ev=PageView&noscript=1"
    /></noscript>
</div>

<script>
    function createCookie(name, value, days) {
        let expires = "";
        if (days) {
            const date = new Date();
            date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));
            expires = "; expires=" + date.toUTCString();
        }
        document.cookie = name + "=" + value + expires + "; path=/";
    }

    function readCookie(name) {
        const nameEQ = name + "=";
        const ca = document.cookie.split(';');
        for (let i = 0; i < ca.length; i++) {
            let c = ca[i];
            while (c.charAt(0) === ' ') c = c.substring(1, c.length);
            if (c.indexOf(nameEQ) === 0) return c.substring(nameEQ.length, c.length);
        }
        return null;
    }

    function eraseCookie(name) {
        createCookie(name, "", -1);
    }

    function hideConsent() {
        document.getElementById('cookie-notice').style.display = 'none';
    }

    if (readCookie('cookie-notice-dismissed') === 'true') {!function (f, b, e, v, n, t, s) {
    if (f.fbq) return;
    n = f.fbq = function () {
        n.callMethod ?
            n.callMethod.apply(n, arguments) : n.queue.push(arguments)
    };
    if (!f._fbq) f._fbq = n;
    n.push = n;
    n.loaded = !0;
    n.version = '2.0';
    n.queue = [];
    t = b.createElement(e);
    t.async = !0;
    t.src = v;
    s = b.getElementsByTagName(e)[0];
    s.parentNode.insertBefore(t, s)
}(window, document, 'script',
    'https://connect.facebook.net/en_US/fbevents.js');
fbq('init', '300808861525851');
fbq('track', 'PageView');
} else {
        document.getElementById('cookie-notice').style.display = 'flex';
    }

    document.getElementById('cookie-notice-accept').addEventListener("click", function () {
        createCookie('cookie-notice-dismissed', 'true', 31);
        hideConsent();
        location.reload();
    });
</script>

</body>
</html>
